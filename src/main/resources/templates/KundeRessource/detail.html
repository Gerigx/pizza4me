{#include HomeRessource/base.html}
{#title}{kunde.getFullName}{/title}
{#main}
<div class="row">
    <div class="col-md-8">
        <h1>{kunde.getFullName}</h1>
        
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">PersÃ¶nliche Daten</h5>
                <p><strong>Vorname:</strong> {kunde.vorname}</p>
                <p><strong>Nachname:</strong> {kunde.nachname}</p>
                <p><strong>Username:</strong> {kunde.username}</p>
                <p><strong>Rolle:</strong> <span class="badge bg-primary">{kunde.role}</span></p>
                <p><strong>ID:</strong> {kunde.id}</p>
            </div>
        </div>

        {#if kunde.adresse}
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">ğŸ“ Adresse</h5>
                <p>
                    {kunde.adresse.strasse}<br>
                    {kunde.adresse.plz} {kunde.adresse.ort}<br>
                    {kunde.adresse.land ?: 'Deutschland'}
                </p>
                <a href="/kunde/{kunde.id}/adresse" class="btn btn-sm btn-outline-primary">Adresse bearbeiten</a>
            </div>
        </div>
        {#else}
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">ğŸ“ Adresse</h5>
                <p class="text-muted">Keine Adresse hinterlegt</p>
                <a href="/kunde/{kunde.id}/adresse" class="btn btn-sm btn-primary">Adresse hinzufÃ¼gen</a>
            </div>
        </div>
        {/if}

        {#if kunde.orders && !kunde.orders.isEmpty()}
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">ğŸ“‹ Bestellungen</h5>
                <p><strong>Anzahl Bestellungen:</strong> {kunde.orders.size()}</p>
                <small class="text-muted">Order IDs: {kunde.orders}</small>
            </div>
        </div>
        {/if}
        
        <div class="mt-4">
            <a href="/kunden" class="btn btn-secondary">â† ZurÃ¼ck zur Liste</a>
            <button class="btn btn-primary" onclick="editKunde({kunde.id})">Bearbeiten</button>
            <button class="btn btn-danger" onclick="deleteKunde({kunde.id})">LÃ¶schen</button>
        </div>
    </div>
    
    <div class="col-md-4">
        <!-- Debug Panel -->
        <div class="card bg-light">
            <div class="card-body">
                <h6>ğŸ”§ Debug Info</h6>
                <p><strong>Template:</strong> KundeRessource/detail.html</p>
                <p><strong>Kunde ID:</strong> {kunde.id}</p>

            </div>
        </div>
        
        <!-- JSON Debug -->
        <div class="card bg-light mt-3">
            <div class="card-body">
                <h6>ğŸ“„ JSON API</h6>
                <a href="/kunde/{kunde.id}" class="btn btn-sm btn-outline-info d-block mb-2" 
                   onclick="fetch(this.href, {headers: {'Accept': 'application/json'}}).then(r=>r.json()).then(console.log)">
                   GET /kunde/{kunde.id}
                </a>
                <a href="/kunde/{kunde.id}/adresse" class="btn btn-sm btn-outline-info d-block" 
                   onclick="fetch(this.href, {headers: {'Accept': 'application/json'}}).then(r=>r.json()).then(console.log)">
                   GET /kunde/{kunde.id}/adresse
                </a>
            </div>
        </div>
    </div>
</div>

<script>
function editKunde(kundeId) {
    // SpÃ¤ter mit echtem Edit-Form
    alert('Edit Kunde ' + kundeId + ' - noch nicht implementiert');
}

function deleteKunde(kundeId) {
    if (confirm('Kunde ' + kundeId + ' wirklich lÃ¶schen?')) {
        fetch('/kunde/' + kundeId, { method: 'DELETE' })
            .then(response => {
                if (response.ok) {
                    alert('Kunde gelÃ¶scht!');
                    window.location.href = '/kunden';
                } else {
                    alert('Fehler beim LÃ¶schen');
                }
            })
            .catch(err => alert('Fehler: ' + err));
    }
}
</script>
{/main}
{/include}